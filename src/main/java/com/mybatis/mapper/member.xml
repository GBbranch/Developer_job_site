<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="Member">
 	<!-- <select id="login" parameterType="hashmap" resultType="memberdto">
 		SELECT * FROM MEMBER WHERE USERID = #{userid} AND PASSWORD = #{password}
 	</select>
 	
 	<insert id="sigup" parameterType="hashmap">
 		INSERT INTO "MEMBER" m (
			m.ID , m.USERID, m.PASSWORD, 
			m.NAME, m.GENDER, m.BIRTHDAY, 
			m.PHONE, m.EMAIL, m.ADDRESS, 
			m.DETAIL_ADDR)
			VALUES (
				member_seq.nextval
			,	#{userid}
			,	#{password}
			,	#{name}
			,	#{gender}
			,	#{birthday}
			,	#{phone}
			,	#{email}
			,	#{address}
			,	#{detail_addr}
		)
 	</insert> -->
 	
 	<insert id="sigup" parameterType="hashmap">
 		INSERT INTO "MEMBER" m VALUES (
			MEMBER_SEQ.nextval
			,	#{userid}
			,	#{password}
			,	#{name}
			,	(SELECT g.ID FROM GENDER g WHERE g.TITLE = 'male')
			,	#{birthday}
			,	#{phone}
			,	#{email}
			,	(SELECT a.ID FROM ADDRESS a WHERE a.DISTRICT = #{address})
			,	#{detail_addr}
		)
 	</insert>
 	
 	<select id="login" parameterType="hashmap" resultType="memberdto">
 		SELECT 
			m.ID , m.USER_ID , m.PASSWORD, m.NAME,
			g.TITLE AS GENDER , m.BIRTHDAY , m.EMAIL,
			a.DISTRICT AS ADDRESS, m.DETAIL_ADDR 
		FROM "MEMBER" m 
		LEFT OUTER JOIN ADDRESS a 
			ON m.ADDRESS_ID = a.ID 
		LEFT OUTER JOIN GENDER g 
			ON m.GENDER_ID = g.ID 
		WHERE m.USER_ID = #{userid} AND m.PASSWORD = #{password}
 	</select>
 	
 </mapper>